(function(w){"use strict";var loadCSS=function(href,before,media){var doc=w.document;var ss=doc.createElement("link");var ref;if(before){ref=before}else{var refs=(doc.body||doc.getElementsByTagName("head")[0]).childNodes;ref=refs[refs.length-1]}var sheets=doc.styleSheets;ss.rel="stylesheet";ss.href=href;ss.media="only x";function ready(cb){if(doc.body){return cb()}setTimeout(function(){ready(cb)})}ready(function(){ref.parentNode.insertBefore(ss,before?ref:ref.nextSibling)});var onloadcssdefined=function(cb){var resolvedHref=ss.href;var i=sheets.length;while(i--){if(sheets[i].href===resolvedHref){return cb()}}setTimeout(function(){onloadcssdefined(cb)})};function loadCB(){if(ss.addEventListener){ss.removeEventListener("load",loadCB)}ss.media=media||"all"}if(ss.addEventListener){ss.addEventListener("load",loadCB)}ss.onloadcssdefined=onloadcssdefined;onloadcssdefined(loadCB);return ss};if(typeof exports!=="undefined"){exports.loadCSS=loadCSS}else{w.loadCSS=loadCSS}})(typeof global!=="undefined"?global:this);(function(w){if(!w.loadCSS){return}var rp=loadCSS.relpreload={};rp.support=function(){try{return w.document.createElement("link").relList.supports("preload")}catch(e){return false}};rp.poly=function(){var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"){w.loadCSS(link.href,link);link.rel=null}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,300);if(w.addEventListener){w.addEventListener("load",function(){w.clearInterval(run)})}if(w.attachEvent){w.attachEvent("onload",function(){w.clearInterval(run)})}}})(this);(function(document,window){function Tap(el){this.el=typeof el==="object"?el:document.getElementById(el);this.moved=false;this.startX=0;this.startY=0;this.hasTouchEventOccured=false;this.el.addEventListener("touchstart",this,false);this.el.addEventListener("mousedown",this,false)}Tap.prototype.leftButton=function(event){if("buttons"in event){return event.buttons===1}else{return"which"in event?event.which===1:event.button===1}return false};Tap.prototype.start=function(e){if(e.type==="touchstart"){this.hasTouchEventOccured=true;this.el.addEventListener("touchmove",this,false);this.el.addEventListener("touchend",this,false);this.el.addEventListener("touchcancel",this,false)}else if(e.type==="mousedown"&&this.leftButton(e)){this.el.addEventListener("mousemove",this,false);this.el.addEventListener("mouseup",this,false)}this.moved=false;this.startX=e.type==="touchstart"?e.touches[0].clientX:e.clientX;this.startY=e.type==="touchstart"?e.touches[0].clientY:e.clientY};Tap.prototype.move=function(e){var x=e.type==="touchmove"?e.touches[0].clientX:e.clientX;var y=e.type==="touchmove"?e.touches[0].clientY:e.clientY;if(Math.abs(x-this.startX)>10||Math.abs(y-this.startY)>10){this.moved=true}};Tap.prototype.end=function(e){var evt;this.el.removeEventListener("touchmove",this,false);this.el.removeEventListener("touchend",this,false);this.el.removeEventListener("touchcancel",this,false);this.el.removeEventListener("mouseup",this,false);this.el.removeEventListener("mousemove",this,false);if(!this.moved){try{evt=new window.CustomEvent("tap",{bubbles:true,cancelable:true})}catch(e){evt=document.createEvent("Event");evt.initEvent("tap",true,true)}e.stopPropagation();if(!e.target.dispatchEvent(evt)){e.preventDefault()}}};Tap.prototype.cancel=function(){this.hasTouchEventOccured=false;this.moved=false;this.startX=0;this.startY=0};Tap.prototype.destroy=function(){this.el.removeEventListener("touchstart",this,false);this.el.removeEventListener("touchmove",this,false);this.el.removeEventListener("touchend",this,false);this.el.removeEventListener("touchcancel",this,false);this.el.removeEventListener("mousedown",this,false);this.el.removeEventListener("mouseup",this,false);this.el.removeEventListener("mousemove",this,false)};Tap.prototype.handleEvent=function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":this.end(e);break;case"touchcancel":this.cancel(e);break;case"mousedown":this.start(e);break;case"mouseup":this.end(e);break;case"mousemove":this.move(e);break}};function polyfillRequestAnimationFrame(){var lastTime=0;var vendors=["webkit","moz"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id)}}}function getBrowserCapabilities(){var styles=window.getComputedStyle(document.documentElement,"");var pre=(Array.prototype.slice.call(styles).join("").match(/-(moz|webkit|ms)-/)||styles.OLink===""&&["","o"])[1];return{prefix:"-"+pre+"-",transform:pre[0].toUpperCase()+pre.substr(1)+"Transform"}}function loadJS(src,callback){var r=false,s=document.createElement("script"),t=document.getElementsByTagName("script")[0];s.type="text/javascript";s.src=src;s.onload=s.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState=="complete")){r=true;callback()}};t.parentNode.insertBefore(s,t)}function createSidebar(sidebar,backdrop,menu){polyfillRequestAnimationFrame();new Tap(backdrop);new Tap(menu);var browerCapabilities=getBrowserCapabilities();var transformProperty=browerCapabilities.transform;var IDLE="IDLE";var START_TOUCHING="START_TOUCHING";var TOUCHING="TOUCHING";var START_ANIMATING="START_ANIMATING";var ANIMATING="ANIMATING";var DURATION=200;var MAX_OPACITY=.67;var VELOCITY_THRESHOLD=.33;var VELOCITY_LINEAR_COMBINATION=.6;var startX=0;var startY=0;var pageX=0;var pageY=0;var lastPageX=0;var lastPageY=0;var isScrolling=undefined;var startedMoving=false;var state=IDLE;var menuOpen=0;var velocity=0;var startTranslateX=0;var translateX=0;var animationFrameRequested=false;var animationStartTime;var animationStartX;var animationEndX;var animationChangeInValue;var lastTime;var timeDiff;var sliderWidth;function requestAnimationLoop(){if(!animationFrameRequested){animationFrameRequested=true;requestAnimationFrame(animationLoop)}}function distanceToLastTouch(p){return Math.sqrt(Math.pow(pageX-p.pageX,2)+Math.pow(pageY-p.pageY,2))}function getNearestTouch(touches){return Array.prototype.reduce.call(touches,function(acc,touch){var dist=distanceToLastTouch(touch);return dist<acc.dist?{dist:dist,touch:touch}:acc},{dist:Number.POSITIVE_INFINITY,touch:null}).touch}function onTouchMove(e){var touch=getNearestTouch(e.touches);pageX=touch.pageX;pageY=touch.pageY;if(typeof isScrolling==="undefined"&&startedMoving){isScrolling=Math.abs(startY-pageY)>Math.abs(startX-pageX);if(!isScrolling){state=START_TOUCHING;requestAnimationLoop()}}if(isScrolling&&!menuOpen)return;e.preventDefault();startedMoving=true}function onTouchEnd(e){if(isScrolling||e.touches.length>0){return}if(startedMoving){menuOpen=velocity>VELOCITY_THRESHOLD?1:velocity<-VELOCITY_THRESHOLD?0:translateX>=sliderWidth/2?1:0}state=START_ANIMATING;startedMoving=false;document.removeEventListener("touchmove",onTouchMove);document.removeEventListener("touchend",onTouchEnd)}function onTouchStart(e){function isCodeBlock(path){for(var i=0;i<path.length;i++){var node=path[i];var classList=node.classList;if(classList&&(classList.contains("highlight")||classList.contains("katex-display"))&&node.scrollLeft>0){return true}}return false}if(e.touches.length===1){isScrolling=undefined;var touch=e.touches[0];startX=pageX=lastPageX=touch.pageX;startY=pageY=lastPageY=touch.pageY;if(menuOpen||!menuOpen&&pageX<window.innerWidth/3&&!isCodeBlock(e.path)){document.addEventListener("touchmove",onTouchMove);document.addEventListener("touchend",onTouchEnd)}}}function onMenuClick(e){e.preventDefault();animateTo(1)}function onBackdropClick(e){e.preventDefault();animateTo(0)}function animateTo(_menuOpen){state=START_ANIMATING;menuOpen=_menuOpen;requestAnimationLoop()}function linearTween(t,b,c,d){return c*t/d+b}function getMovableSliderWidth(){return-sidebar.offsetLeft}function animationLoop(time){switch(state){case START_TOUCHING:sliderWidth=getMovableSliderWidth();state=TOUCHING;case TOUCHING:timeDiff=time-lastTime;if(timeDiff>0){velocity=VELOCITY_LINEAR_COMBINATION*(pageX-lastPageX)/timeDiff+(1-VELOCITY_LINEAR_COMBINATION)*velocity}var deltaX=pageX-startX;translateX=startTranslateX+deltaX;translateX=Math.max(0,Math.min(sliderWidth,translateX));updateDOM(translateX,sliderWidth);lastTime=time;lastPageX=pageX;lastPageY=pageY;requestAnimationFrame(animationLoop);break;case START_ANIMATING:sliderWidth=getMovableSliderWidth();var deltaX=pageX-startX;translateX=startTranslateX+deltaX;translateX=Math.max(0,Math.min(sliderWidth,translateX));animationStartX=translateX;animationEndX=menuOpen*sliderWidth;animationChangeInValue=animationEndX-animationStartX;animationStartTime=time;state=ANIMATING;case ANIMATING:var t=time-animationStartTime;if(t<DURATION){startTranslateX=linearTween(t,animationStartX,animationChangeInValue,DURATION);requestAnimationFrame(animationLoop)}else{startTranslateX=animationEndX;animationFrameRequested=false;velocity=0;if(menuOpen===1){document.body.classList.add("drawer-open")}else{document.body.classList.remove("drawer-open")}}updateDOM(startTranslateX,sliderWidth);break}}function updateDOM(translateX,sliderWidth){sidebar.style[transformProperty]="translate3d("+translateX+"px,0,0)";backdrop.style["opacity"]=MAX_OPACITY*(translateX/sliderWidth)}function enableSlider(){document.body.classList.add("drawer");document.addEventListener("touchstart",onTouchStart);menu.addEventListener("tap",onMenuClick);backdrop.addEventListener("tap",onBackdropClick);animateTo(menuOpen)}function disableSlider(){document.body.classList.remove("drawer");document.removeEventListener("touchstart",onTouchStart);menu.removeEventListener("tap",onMenuClick);backdrop.removeEventListener("tap",onBackdropClick)}function onResize(){if(window.matchMedia("(min-width: 48em)").matches){disableSlider()}else{enableSlider()}}window.addEventListener("resize",onResize);window.addEventListener("orientationchange",onResize);onResize()}var sidebar=document.getElementById("_sidebar");var backdrop=document.getElementById("_backdrop");var menu=document.getElementById("_menu");createSidebar(sidebar,backdrop,menu);var mathBlocks=document.querySelectorAll('script[type^="math/tex"]');if(mathBlocks.length){loadCSS("https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css");loadJS("https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js",function(){requestAnimationFrame(function(){document.body.classList.add("katex-loaded");Array.prototype.forEach.call(mathBlocks,function(el){var tex=el.textContent.replace("% <![CDATA[","").replace("%]]>","");el.outerHTML=katex.renderToString(tex,{displayMode:el.type==="math/tex; mode=display"})})})})}})(document,window);
